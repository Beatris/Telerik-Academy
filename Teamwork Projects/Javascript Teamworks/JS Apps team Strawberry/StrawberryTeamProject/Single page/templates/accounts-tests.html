<link rel="stylesheet" href="https://d10ajoocuyu32n.cloudfront.net/mobile/1.3.1/jquery.mobile-1.3.1.min.css">
	  
  <!-- Angular.js -->  
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>

  <!-- jQuery and jQuery Mobile -->

    <style>
	    div > ul > li a > span{
	        display: inline-block;
	        float: right;
	        color: #61B329;
	        font-size: 14px;
	        text-shadow: 1px 1px 0px green;
	    }

	   span.totalAccountsSum{
	        display: inline-block;
	        float: right;
	        color: white;
	    }
   </style>
</head>
	 
<body>
	<!-- Home -->
<div data-role="page" id="page1">
    <div data-theme="a" data-role="header">
        <a id="add-new-account-button" data-role="button" href="#page1" data-icon="plus" data-iconpos="right"
        class="ui-btn-right">
            Add
        </a>
        <a data-role="button" href="#page1" data-icon="home" data-iconpos="left"
        class="ui-btn-left">
            Home
        </a>
        <h3>
            Accounts <span id="totalBalance"></span>
        </h3>
    </div>
    <div data-role="content">
        <div id="acc-container" data-role="collapsible-set" data-theme="b" data-content-theme="a">
        </div>
    </div>
    <div data-theme="a" data-role="footer" data-position="fixed">
        <h3>
            Footer
        </h3>
    </div>

</div>


<script type="text/javascript">
    // credit cards have negative balance, can buy anything when balance is negative

    accounts.init();

    accounts.addAccount("credit", "Visa", -720.00, "16/09/2014");
    accounts.addAccount("credit", "Master Card", -1520.00, "16/11/2014");
    accounts.addAccount("debit", "Visa Electron", 1280.24, "24/11/2014");
    accounts.addAccount("debit", "Visa Electron FB", 1290.24, "24/11/2015");
    accounts.addAccount("debit", "Maestro", 2670.21, "24/11/2015");
    accounts.addFunds("cash", "", 1200.00, "11/5/2013", "regular salary", "salary");

    expenses.addExpense("foodAndGroceries", "groceries", "27/05/2013", 42.66, "cash", "cash", "Jack Daniels bottle");
    expenses.addExpense("medical", "dentist", "20/05/2013", 100.00, "credit", "Visa", "dentist");
    expenses.addExpense("foodAndGroceries", "fastFood", "13/05/2013", 14.66, "cash", "cash", "Subway sandwiches");
    expenses.addExpense("entertainment", "discos", "14/06/2013", 157.99, "credit", "Master Card", "Plazza");
    expenses.addExpense("foodAndGroceries", "groceries", "05/06/2013", 60.22, "credit", "Master Card", "Kaufland");
    expenses.addExpense("foodAndGroceries", "groceries", "05/06/2013", 60.22, "debit", "Visa Electron", "Kaufland");

    var allAccounts = storage.load("accounts");
    var totalBalance = accounts.totalBalance();
    $("#totalBalance").text(totalBalance).css({ 'font-size': "14px", 'color': "#61B329", 'text-shadow': "text-shadow: 1px 1px 0px green" });

    $("#add-new-account-button").on('click', function(){
    	location.href="AddAccount.html";
    })

    for (var type in allAccounts) {

        var accType = accounts.accTypeParser(type);
        var totalBalance = accounts.totalBalance(type);

        $collapse = $('<div></div>')
		.attr({ 'data-role': "collapsible", 'data-collapsed': false })
	    .append($('<h3></h3>')
	        .text(accType)//acc type
	        .append($('<span></span>')
	        	.text("$" + totalBalance)//acc type total sum
	            .addClass("totalAccountsSum")
	        )
	    )

        $ul = $('<ul></ul>')
               .attr({ 'data-role': "listview", 'data-divider-theme': "b", 'data-inset': "true" });
        for (var i = 0; i < allAccounts[type].length; i++) {
            var accName = allAccounts[type][i].name;
            var accBalance = allAccounts[type][i].balance;

            $ul.append($('<li></li>')
	    		.attr({ 'data-theme': "c" })
	    		.append($('<a></a>')
	    			.attr({ 'data-transition': "slide" })
	    			.text(accName)
	    			.append($('<span></span>')
	    				.text("$" + Number(accBalance).toFixed(2))
    				)
	    		).on('click', { type: type, accName: accName }, function (event) {
	    		    var go = "expensesByAccount.html?type=" + event.data.type + "&accName=" + event.data.accName;
	    		    location.href = go;
	    		})
	    	)
            $collapse.append($ul);
        }

        $("#acc-container").append($collapse);
    }
</script>